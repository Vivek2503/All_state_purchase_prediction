{% extends 'Training/index.html' %}
{% load static %}
{% block content %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<div class="row">
    <div class="col-1">
    </div>
    <div class="col-10">
        <h1>Analysis Page</h1>
        <div class="row">
            <div class="col-6">
                <div class="form-group">
                    <label>Choose Option</label>
                    <select class="form-control" style="height:35px" onchange="barGraph()"
                        id="option" name="option" required>
                        <option value='-1'>Chose Option</option>
                        {% comment %} <option value='risk_factor'>Risk factor</option> {% endcomment %}
                        <option value='married_couple'>Married</option>
                        {% comment %} <option value='state'>State</option> {% endcomment %}
                        <option value='homeowner'>Home Owner</option>
                        <option value='group_size'>Group Size</option>
                        {% comment %} <option value='car_age'>Car Age</option>                        {% endcomment %}
                        <option value='car_value'>Car Value</option>
                        <option value='C_previous'>C Previous</option>                   
                        {% comment %} <option value='age_youngest'>Youngest Age</option> {% endcomment %}
                        {% comment %} <option value='age_oldest'>Oldest Age</option> {% endcomment %}
                        <option value='duration_previous'>Previous Duration</option>
                        <option value='A'>A</option>
                        <option value='B'>B</option>
                        <option value='C'>C</option>
                        <option value='D'>D</option>
                        <option value='E'>E</option>
                        <option value='F'>F</option>
                        <option value='G'>G</option>
                    </select>
                </div>
            </div>

            <div class="col-6">
                <div class="form-group">
                    <label>Dependant Variable</label>
                    <select class="form-control" style="height:35px" onchange="barGraph()"
                        id="variable" name="option" required>
                        <option value='A'>A</option>
                        <option value='B'>B</option>
                        <option value='C'>C</option>
                        <option value='D'>D</option>
                        <option value='E'>E</option>
                        <option value='F'>F</option>
                        <option value='G'>G</option>
                    </select>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
        <canvas id="Chart1"></canvas>

        <script>

            function getRandomColor() {
                var letters = '0123456789ABCDEF';
                var color = '#';
                for (var i = 0; i < 6; i++) {
                    color += letters[Math.floor(Math.random() * 16)];
                }
                return color;
                }
            function barGraph() {           
                var myList={{context|safe}};
                var option=document.getElementById('option').value;
                var dependant=document.getElementById('variable').value;
                var data=myList[option][dependant];
                var labels=[]
                var values=[]
                for (var row in data) {                    
                    var obj=data[row];
                    labels.push(row);
                    var l=[];
                    for(var col in obj)
                    l.push(data[row][col]);
                    values.push(l);
                }
                var dataset=[];
                for(var i in values)
                {
                    var obj={};
                    obj['data']=values[i];
                    obj['backgroundColor']=getRandomColor();
                    dataset.push(obj);
                }
                var myChart;

                var ctx = document.getElementById("Chart1");
                var barOptions_stacked = {
                    tooltips: {
                        enabled: false
                    },
                    hover :{
                        animationDuration:0
                    },
                    scales: {
                        xAxes: [{
                            ticks: {
                                beginAtZero:true,
                                fontFamily: "'Open Sans Bold', sans-serif",
                                fontSize:11
                            },
                            scaleLabel:{
                                display:false
                            },
                            gridLines: {
                            }, 
                            stacked: true
                        }],
                        yAxes: [{
                            gridLines: {
                                display:false,
                                color: "#fff",
                                zeroLineColor: "#fff",
                                zeroLineWidth: 0
                            },
                            ticks: {
                                fontFamily: "'Open Sans Bold', sans-serif",
                                fontSize:11
                            },
                            stacked: true
                        }]
                    },
                    legend:{
                        display:false
                    },                    
                    pointLabelFontFamily : "Quadon Extra Bold",
                    scaleFontFamily : "Quadon Extra Bold",
                };
                  if(window.bar != undefined)
                    window.bar.destroy();
            window.bar = new Chart(ctx, {
                type: 'horizontalBar',
                data: {
                    labels: labels,
                    
                    datasets:dataset,
                },
                options: barOptions_stacked,
            });
            }
        </script>

    </div>
    <div class="col-1">
    </div>
</div>



{% endblock %}